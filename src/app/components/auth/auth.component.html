<div class="auth-box">
  <div class="header">
    <h2>Clínica Monteluz</h2>
    <p>{{ authMode() === 'login' ? 'Bienvenido de vuelta' : 'Crea tu cuenta para empezar' }}</p>
  </div>
  <form [formGroup]="authForm" (ngSubmit)="handleAuth()">

    <ng-container *ngIf="authMode() === 'register'">
      <div class="form-group">
        <label for="fullName">Nombre Completo</label>
        <input id="fullName" type="text" formControlName="fullName" placeholder="John Doe">
      </div>
      <div class="role-selector">
        <label>Soy:</label>
        <div class="role-buttons">
          <button type="button" [class.active]="role() === 'patient'" (click)="role.set('patient')">Paciente</button>
          <button type="button" [class.active]="role() === 'doctor'" (click)="role.set('doctor')">Doctor</button>
        </div>
      </div>
    </ng-container>

    <div class="form-group">
      <label for="email">Correo Electrónico</label>
      <input id="email" type="email" formControlName="email" placeholder="email@ejemplo.com">
    </div>
    <div class="form-group">
      <label for="password">Contraseña</label>
      <input id="password" type="password" formControlName="password" placeholder="••••••••">
    </div>

    <ng-container *ngIf="authMode() === 'register' && role() === 'doctor'">
      <div class="form-group">
        <label for="specialty">Especialidad</label>
        <select id="specialty" formControlName="specialty_id">
          <option [ngValue]="null" disabled>Seleccione una especialidad</option>
          <option *ngFor="let spec of dataService.specialties()" [value]="spec.id">{{ spec.name }}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="license">Número de Licencia</label>
        <input type="text" id="license" formControlName="license_number">
      </div>
    </ng-container>

    <button class="submit-btn" type="submit" [disabled]="loading() || authForm.invalid">
      {{ loading() ? 'Cargando...' : (authMode() === 'login' ? 'Iniciar Sesión' : 'Registrarse') }}
    </button>
  </form>
  <div class="switch-mode">
    <p *ngIf="authMode() === 'login'">
      ¿No tienes cuenta? <a (click)="authMode.set('register')">Regístrate aquí</a>
    </p>
    <p *ngIf="authMode() === 'register'">
      ¿Ya tienes una cuenta? <a (click)="authMode.set('login')">Inicia sesión</a>
    </p>
  </div>
</div>