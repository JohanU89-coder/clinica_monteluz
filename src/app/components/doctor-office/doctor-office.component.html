<div class="page-container">
  <header class="page-header">
    <div class="header-content">
      <div>
        <h1>Mi Consultorio</h1>
        <p>Configura tu disponibilidad semanal para que los pacientes puedan encontrarte.</p>
      </div>
      <div class="stats-badge" *ngIf="totalBlocks() > 0">
        <span class="count">{{ totalBlocks() }}</span>
        <span class="label">Bloques Activos</span>
      </div>
    </div>
  </header>

  <div class="office-layout">
    
    <section class="weekly-grid fade-in">
      <div class="grid-header">
        <h3>Tu Semana Laboral</h3>
        <p class="subtitle">Tus horarios visibles para los pacientes</p>
      </div>

      <ng-container *ngIf="scheduleService.mySchedule().length > 0; else emptyState">
        <div class="days-container">
          <div *ngFor="let day of daysOfWeek" class="day-card" [class.active]="hasSchedules(day.id)">
            <div class="day-header">
              <span class="day-name">{{ day.name }}</span>
              <span class="schedule-count" *ngIf="hasSchedules(day.id)">
                {{ groupedSchedules()[day.id].length }} turnos
              </span>
            </div>

            <div class="day-body">
              <div *ngIf="!hasSchedules(day.id)" class="no-slots">
                No laboral
              </div>
              
              <div class="slots-list" *ngIf="hasSchedules(day.id)">
                <div *ngFor="let slot of groupedSchedules()[day.id]" class="time-chip">
                  <span class="time-range">{{ slot.start_time.slice(0,5) }} - {{ slot.end_time.slice(0,5) }}</span>
                  <button class="remove-btn" (click)="handleDeleteSchedule(slot.id)" title="Eliminar horario">
                    &times;
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-container>

      <ng-template #emptyState>
        <div class="empty-calendar">
          <div class="icon">ðŸ“…</div>
          <h3>Calendario VacÃ­o</h3>
          <p>AÃ±ade tu primer horario en el panel de la derecha para comenzar.</p>
        </div>
      </ng-template>
    </section>

    <aside class="control-panel">
      <div class="panel-card sticky-panel fade-in">
        <div class="panel-header">
          <h3>AÃ±adir Horario</h3>
        </div>
        
        <form [formGroup]="scheduleForm" (ngSubmit)="handleAddSchedule()" class="schedule-form">
          <div class="form-group">
            <label for="day">DÃ­a de la Semana</label>
            <div class="select-wrapper">
              <select id="day" formControlName="day">
                <option [ngValue]="null" disabled>Selecciona dÃ­a...</option>
                <option *ngFor="let day of daysOfWeek" [value]="day.id">{{ day.name }}</option>
              </select>
              <span class="arrow">â–¼</span>
            </div>
          </div>

          <div class="time-inputs-row">
            <div class="form-group half">
              <label for="startTime">Inicio</label>
              <input id="startTime" type="time" formControlName="startTime">
            </div>
            <div class="form-group half">
              <label for="endTime">Fin</label>
              <input id="endTime" type="time" formControlName="endTime">
            </div>
          </div>

          <div class="form-footer">
            <button type="submit" [disabled]="scheduleForm.invalid" class="add-btn">
              <span class="plus">+</span> Agregar Bloque
            </button>
            <p class="helper-text">Recuerda guardar intervalos lÃ³gicos (ej: 09:00 a 13:00).</p>
          </div>
        </form>
      </div>
    </aside>

  </div>
</div>